{
  "meta": {
    "project": "Parking Backend",
    "date": "2025-12-10",
    "prepared_by": "Generated by Software Development Manager"
  },
  "product_overview": "Parking Backend is a robust and scalable REST API system designed for comprehensive parking management. It handles vehicle entry and exit registration, automatic tariff calculations, user and role management with secure JWT authentication, detailed auditing, data backup and restoration, and real-time statistics and reporting.",
  "core_goals": [
    "Provide a secure and well-documented REST API backend for parking management.",
    "Implement JWT-based authentication and role-based access control (RBAC).",
    "Ensure data integrity through comprehensive audit logging.",
    "Facilitate efficient backup and restoration of data.",
    "Enable generation of detailed reports and real-time statistical insights.",
    "Achieve high performance with API response times under 500ms for 95% of requests.",
    "Maintain system availability of 99.5% uptime."
  ],
  "key_features": [
    "JWT Authentication and Authorization with defined user roles (admin, operator).",
    "Complete CRUD operations for vehicles, tickets, and users.",
    "Automatic ticket creation with tariff calculation and status management.",
    "Generation of income reports and occupancy statistics.",
    "Comprehensive audit trail recording all changes and user actions.",
    "Automated backups in SQL and JSON formats with restoration capabilities.",
    "Real-time insights and analytics on system usage and revenues.",
    "Security measures including rate limiting, CORS, Helmet headers, and password encryption with bcryptjs.",
    "Centralized error handling middleware and input validation using Express Validator and Joi.",
    "Detailed logging using Winston and API documentation via Swagger/OpenAPI 3.0."
  ],
  "user_flow_summary": [
    "User registers or logs in via POST /api/auth/register or POST /api/auth/login, receiving a JWT token.",
    "Authenticated user accesses vehicle management endpoints to register vehicle entries and exits, or perform CRUD operations.",
    "User creates and manages parking tickets, with the system calculating tariffs automatically.",
    "Admins generate and retrieve reports on income and parking statistics.",
    "Audit logs track every user action with endpoints to review changes.",
    "Users interact with backup endpoints to create or restore data snapshots.",
    "System provides endpoints to view system status and real-time analytics data.",
    "Middleware layers ensure requests are authenticated, validated, and logged before business logic execution."
  ],
  "validation_criteria": [
    "All API endpoints pass functional unit and integration tests with coverage >= 80%.",
    "Authentication and authorization correctly enforce access controls based on user roles.",
    "Backup and restore features successfully create and recover database snapshots without data loss.",
    "Audit logs accurately record all user actions and data changes.",
    "Reports generate accurate and complete income and occupancy statistics.",
    "API response times meet the <500ms target for 95% of valid requests.",
    "System uptime and availability meet or exceed 99.5%.",
    "Security controls including JWT, rate limiting, Helmet, CORS, and input validation are fully effective and tested.",
    "API documentation is complete, up to date, and accessible at /api-docs.",
    "Error handling middleware correctly manages and logs all errors encountered during requests."
  ],
  "code_summary": {
    "project_name": "Parking Backend",
    "project_type": "REST API Backend",
    "description": "Sistema de gestión y cobro de tarifas de estacionamiento con autenticación JWT",
    "tech_stack": {
      "runtime": "Node.js",
      "framework": "Express.js 5.1.0",
      "database": "MySQL 8.0+",
      "orm_database_client": "mysql2",
      "authentication": "JWT (jsonwebtoken 9.0.2)",
      "password_encryption": "bcryptjs 3.0.3",
      "api_documentation": "Swagger/OpenAPI 3.0",
      "logging": "Winston 3.18.3",
      "security": "Helmet 8.1.0, CORS, Rate Limiting",
      "validation": "Express Validator 7.3.0, Joi 18.0.2",
      "testing": "Jest, TestSprite",
      "development_tools": "Nodemon, JSDoc"
    },
    "main_features": [
      {
        "name": "Autenticación y Autorización",
        "description": "Sistema JWT con roles de usuario (admin, operator)",
        "endpoints": [
          "POST /api/auth/login",
          "POST /api/auth/register",
          "POST /api/auth/logout"
        ]
      },
      {
        "name": "Gestión de Vehículos",
        "description": "Registro de entrada/salida de vehículos al estacionamiento",
        "endpoints": [
          "GET /api/vehicles",
          "POST /api/vehicles",
          "PUT /api/vehicles/:id",
          "DELETE /api/vehicles/:id"
        ]
      },
      {
        "name": "Gestión de Tickets",
        "description": "Creación y gestión de tickets de estacionamiento",
        "endpoints": [
          "GET /api/tickets",
          "POST /api/tickets",
          "PUT /api/tickets/:id",
          "DELETE /api/tickets/:id"
        ]
      },
      {
        "name": "Reportes",
        "description": "Generación de reportes de ingresos y estadísticas",
        "endpoints": [
          "GET /api/reports",
          "POST /api/reports/generate"
        ]
      },
      {
        "name": "Gestión de Usuarios",
        "description": "CRUD de usuarios con control de roles",
        "endpoints": [
          "GET /api/users",
          "POST /api/users",
          "PUT /api/users/:id",
          "DELETE /api/users/:id"
        ]
      },
      {
        "name": "Auditoría",
        "description": "Registro de cambios y acciones de usuarios",
        "endpoints": [
          "GET /api/audit",
          "POST /api/audit"
        ]
      },
      {
        "name": "Backup y Restauración",
        "description": "Backup de base de datos en SQL y JSON",
        "endpoints": [
          "GET /api/backups",
          "POST /api/backups/create",
          "POST /api/backups/restore"
        ]
      },
      {
        "name": "Información del Sistema",
        "description": "Endpoints sobre el estado y versión de la aplicación",
        "endpoints": [
          "GET /api/about"
        ]
      },
      {
        "name": "Insights / Estadísticas",
        "description": "Análisis y estadísticas del sistema",
        "endpoints": [
          "GET /api/insights"
        ]
      }
    ],
    "core_modules": {
      "controllers": [
        "aboutController",
        "auditController",
        "authController",
        "backupController",
        "insightsController",
        "reportController",
        "ticketController",
        "userController",
        "vehicleController"
      ],
      "services": [
        "aboutService",
        "auditService",
        "backupSqlService",
        "reportService",
        "ticketService",
        "userService",
        "vehicleService"
      ],
      "middleware": [
        "auth.js - Validación JWT",
        "authValidation.js - Validación de credenciales",
        "errorHandler.js - Manejo centralizado de errores",
        "validation.js - Validación de datos"
      ]
    },
    "security_features": [
      "Autenticación JWT",
      "Control de acceso basado en roles (RBAC)",
      "Rate limiting",
      "CORS configurado",
      "Helmet para headers de seguridad",
      "Encriptación de contraseñas con bcryptjs",
      "Validación y sanitización de entrada"
    ],
    "database_operations": [
      "CRUD de vehículos",
      "CRUD de tickets",
      "CRUD de usuarios",
      "Registro de auditoría",
      "Generación de reportes",
      "Backup y restauración de BD"
    ],
    "api_documentation": "Swagger/OpenAPI 3.0 disponible en /api-docs",
    "logging": "Winston para logging de eventos y errores",
    "error_handling": "Middleware centralizado de manejo de errores",
    "version": "1.0.0"
  }
}
