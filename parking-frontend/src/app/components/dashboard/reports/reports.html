<div class="tab-content" [class.active]="activeTab === 'reports' && !isLoading">
      <div class="form-card">
        <div class="form-card-header">
          <div class="form-card-title">Reportes</div>
          <div class="form-card-description">Generar reportes de ingresos y estadísticas</div>
        </div>
        <div class="form-card-content">
          <!-- Filtros de Reporte -->
          <div class="form-grid" style="margin-bottom: 1.5rem;">
            <div class="form-group">
              <label class="form-label" for="reportType">Tipo de Reporte</label>
              <select class="form-select" id="reportType" [(ngModel)]="reportType" (change)="onReportTypeChange()">
                <option value="daily">Reporte Diario</option>
                <option value="custom">Reporte Personalizado</option>
              </select>
            </div>
            
            <!-- Filtro para reporte diario -->
            <div class="form-group" *ngIf="reportType === 'daily'">
              <label class="form-label" for="dailyRange">Rango</label>
              <select class="form-select" id="dailyRange" [(ngModel)]="dailyRange" (change)="onDailyRangeChange()">
                <option value="today">Hoy</option>
                <option value="last_week">Última Semana</option>
                <option value="last_month">Último Mes</option>
              </select>
            </div>

            <!-- Filtros para reporte personalizado -->
            <div class="form-group" *ngIf="reportType === 'custom'">
              <label class="form-label" for="startDate">Fecha Inicio</label>
              <input 
                class="form-input" 
                type="date" 
                id="startDate"
                [(ngModel)]="startDate"
                [max]="endDate || maxDate">
            </div>
            
            <div class="form-group" *ngIf="reportType === 'custom'">
              <label class="form-label" for="endDate">Fecha Fin</label>
              <input 
                class="form-input" 
                type="date" 
                id="endDate"
                [(ngModel)]="endDate"
                [min]="startDate"
                [max]="maxDate">
            </div>

            <div class="form-group" style="align-items: flex-end;">
              <button 
                class="form-button" 
                (click)="generateReport()"
                [disabled]="isGeneratingReport || !isReportFormValid()">
                <svg class="button-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                  <polyline points="14 2 14 8 20 8"></polyline>
                  <line x1="16" y1="13" x2="8" y2="13"></line>
                  <line x1="16" y1="17" x2="8" y2="17"></line>
                  <polyline points="10 9 9 9 8 9"></polyline>
                </svg>
                {{ isGeneratingReport ? 'Generando...' : 'Generar Reporte' }}
              </button>
            </div>
          </div>

          <!-- Resultados del Reporte -->
          <div *ngIf="reportData && reportData.length > 0" id="reportResults">
            
            <!-- Resumen Estadístico -->
            <div class="stats-grid" style="margin-bottom: 2rem;">
              <div class="stat-card">
                <div class="stat-card-header">
                  <div class="stat-card-title">Total Ingresos</div>
                  <svg class="stat-card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="12" x2="12" y1="2" y2="22"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg>
                </div>
                <div class="stat-card-value">${{ totalIncome | number:'1.2-2' }}</div>
              </div>

              <div class="stat-card">
                <div class="stat-card-header">
                  <div class="stat-card-title">Vehículos Atendidos</div>
                  <svg class="stat-card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path>
                    <circle cx="7" cy="17" r="2"></circle>
                    <path d="M9 17h6"></path>
                    <circle cx="17" cy="17" r="2"></circle>
                  </svg>
                </div>
                <div class="stat-card-value">{{ totalVehicles }}</div>
              </div>

              <div class="stat-card">
                <div class="stat-card-header">
                  <div class="stat-card-title">Duración Promedio</div>
                  <svg class="stat-card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 6v6l4 2"></path>
                    <circle cx="12" cy="12" r="10"></circle>
                  </svg>
                </div>
                <div class="stat-card-value">{{ averageDuration }}</div>
              </div>

              <div class="stat-card">
                <div class="stat-card-header">
                  <div class="stat-card-title">Actualmente Estacionados</div>
                  <svg class="stat-card-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="12" cy="12" r="10"></circle>
                    <path d="M9 17V7h4a3 3 0 0 1 0 6H9"></path>
                  </svg>
                </div>
                <div class="stat-card-value">{{ currentParked }}</div>
              </div>
            </div>

            <!-- Tabla de Reporte Detallado -->
            <div class="table-container">
              <table id="reportTable">
                <thead>
                  <tr>
                    <th>Fecha</th>
                    <th>Tipo de Vehículo</th>
                    <th>Vehículos Atendidos</th>
                    <th>Ingresos</th>
                    <th>Duración Promedio</th>
                  </tr>
                </thead>
                <tbody id="reportTableBody">
                  <tr *ngFor="let item of reportData">
                    <td>{{ extractDateFromISO(item.report_date) }}</td>
                    <td>
                      <span class="badge" 
                            [class.badge-car]="item.vehicleType === 'CAR'" 
                            [class.badge-motorcycle]="item.vehicleType === 'MOTORCYCLE'" 
                            [class.badge-truck]="item.vehicleType === 'TRUCK'">
                        {{ item.vehicle_type_description || getVehicleTypeLabel(item.vehicleType) }}
                      </span>
                    </td>
                    <td>{{ item.vehicles_served }}</td>
                    <td>${{ item.total_income | number:'1.2-2' }}</td>
                    <td>{{ formatDuration(item.avg_duration_minutes) }}</td>
                  </tr>
                </tbody>
                <tfoot *ngIf="reportData.length > 1">
                  <tr style="font-weight: bold; background-color: #f8fafc;">
                    <td>TOTAL</td>
                    <td>-</td>
                    <td>{{ totalVehicles }}</td>
                    <td>${{ totalIncome | number:'1.2-2' }}</td>
                    <td>{{ averageDuration }}</td>
                  </tr>
                </tfoot>
              </table>
            </div>

            <!-- Información del Período -->
            <div class="report-period" style="margin-top: 1rem; padding: 1rem; background-color: #f0f9ff; border-radius: 0.5rem; border: 1px solid #bae6fd;">
              <strong>Período del reporte:</strong> {{ getReportPeriodText() }}
            </div>
          </div>

          <!-- Estado sin datos -->
          <div *ngIf="reportData && reportData.length === 0" class="empty-state">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
              <line x1="16" y1="13" x2="8" y2="13"></line>
              <line x1="16" y1="17" x2="8" y2="17"></line>
              <polyline points="10 9 9 9 8 9"></polyline>
            </svg>
            <p>No hay datos disponibles para el período seleccionado.</p>
          </div>
        </div>
      </div>
    </div>